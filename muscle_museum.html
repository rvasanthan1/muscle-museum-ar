<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Microscopic Giants: Muscle Adaptation</title>
    <!-- Tailwind CSS CDN for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Inter Font -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- React CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Three.js CDN -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <!-- OrbitControls for Three.js -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <!-- FontLoader for Three.js TextGeometry -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/FontLoader.js"></script>
    <!-- TextGeometry for Three.js -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/geometries/TextGeometry.js"></script>
    <!-- Lucide React Icons (inline SVG generation) -->
    <script src="https://unpkg.com/lucide-react@0.395.0/dist/lucide-react.umd.js"></script>

    <style>
        /* Global styles for the body and font */
        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            overflow: hidden; /* Prevent scrolling */
            background-color: #1a202c; /* Dark background for consistency */
        }
        /* Ensure the canvas fills its container */
        #scene-container canvas {
            display: block;
            width: 100%;
            height: 100%;
        }
        /* Keyframe animation for fade-in effect */
        .animate-fade-in-down {
            animation: fadeInDown 0.5s ease-out forwards;
        }
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Main App Component
        const App = () => {
            // Destructure Lucide React icons from the global object inside the component
            const { Circle, Play, Pause, FastForward, Rewind, ZoomIn, ZoomOut, Info, Divide, Plus, Scale, ArrowLeftRight, Activity } = lucideReact;

            const [currentPhase, setCurrentPhase] = React.useState('initial'); // 'initial', 'stimulus', 'adaptation', 'result'
            const [adaptationPathway, setAdaptationPathway] = React.useState(null); // 'hypertrophy', 'hyperplasia'
            const [animationSpeed, setAnimationSpeed] = React.useState(1);
            const [isZoomedIn, setIsZoomedIn] = React.useState(false);
            const [myofiberCount, setMyofiberCount] = React.useState(10); // Initial count
            const [showInfo, setShowInfo] = React.useState(''); // Stores the current info message

            const sceneRef = React.useRef();
            const cameraRef = React.useRef();
            const rendererRef = React.useRef();
            const controlsRef = React.useRef();
            const armModelRef = React.useRef(new THREE.Group()); // Group for the arm model
            const muscleFibersGroupRef = React.useRef(new THREE.Group()); // Group for microscopic muscle fibers
            const raycasterRef = React.useRef(new THREE.Raycaster());
            const mouseRef = React.useRef(new THREE.Vector2());
            const animationFrameId = React.useRef(null);
            const fontRef = React.useRef(null);
            const textMeshesRef = React.useRef([]);

            // Load font for 3D text
            React.useEffect(() => {
                const loader = new THREE.FontLoader();
                loader.load('https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/fonts/helvetiker_regular.typeface.json', (font) => {
                    fontRef.current = font;
                });
            }, []);

            // Function to create 3D text
            const createText = React.useCallback((text, position, color = 0xffffff, size = 0.5) => {
                if (!fontRef.current) return null;
                const geometry = new THREE.TextGeometry(text, {
                    font: fontRef.current,
                    size: size,
                    height: 0.05,
                    curveSegments: 12,
                    bevelEnabled: true,
                    bevelThickness: 0.01,
                    bevelSize: 0.01,
                    bevelOffset: 0,
                    bevelSegments: 5
                });
                geometry.computeBoundingBox();
                const material = new THREE.MeshBasicMaterial({ color: color });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.position.set(position.x, position.y, position.z);
                sceneRef.current.add(mesh);
                textMeshesRef.current.push(mesh);
                return mesh;
            }, []);

            // Scene Initialization
            React.useEffect(() => {
                const scene = new THREE.Scene();
                sceneRef.current = scene;

                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.set(0, 2, 5); // Initial camera position
                cameraRef.current = camera;

                const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setClearColor(0x000000, 0); // Transparent background
                document.getElementById('scene-container').appendChild(renderer.domElement);
                rendererRef.current = renderer;

                const controls = new THREE.OrbitControls(camera, renderer.domElement);
                controls.enableDamping = true;
                controls.dampingFactor = 0.05;
                controls.screenSpacePanning = false;
                controls.maxPolarAngle = Math.PI / 2;
                controlsRef.current = controls;

                // Add ambient light
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.7);
                scene.add(ambientLight);

                // Add directional light
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5);
                directionalLight.position.set(5, 10, 7);
                scene.add(directionalLight);

                // Initial Arm Model (simplified)
                const armGeometry = new THREE.CylinderGeometry(0.5, 0.8, 3, 32);
                const armMaterial = new THREE.MeshPhongMaterial({ color: 0x808080, transparent: true, opacity: 0.4 });
                const arm = new THREE.Mesh(armGeometry, armMaterial);
                arm.position.set(0, 1.5, 0);
                armModelRef.current.add(arm);

                // Biceps (highlighted part)
                const bicepsGeometry = new THREE.SphereGeometry(0.7, 32, 32);
                const bicepsMaterial = new THREE.MeshPhongMaterial({ color: 0x8B0000, transparent: true, opacity: 0.6 });
                const biceps = new THREE.Mesh(bicepsGeometry, bicepsMaterial);
                biceps.position.set(0, 2.5, 0);
                armModelRef.current.add(biceps);
                armModelRef.current.name = 'arm'; // Name for raycasting

                scene.add(armModelRef.current);

                // Microscopic Muscle Fibers (initial state)
                const createMyofiber = (x, y, z, id) => {
                    const fiberGeometry = new THREE.CylinderGeometry(0.05, 0.05, 1, 8);
                    const fiberMaterial = new THREE.MeshPhongMaterial({ color: 0xADD8E6 }); // Light blue for quiescent
                    const fiber = new THREE.Mesh(fiberGeometry, fiberMaterial);
                    fiber.position.set(x, y, z);
                    fiber.rotation.z = Math.PI / 2; // Lay horizontally
                    fiber.userData = { type: 'myofiber', id: `fiber-${id}`, originalScale: fiber.scale.clone() };

                    // Myonuclei
                    const myonucleusGeometry = new THREE.SphereGeometry(0.02, 8, 8);
                    const myonucleusMaterial = new THREE.MeshBasicMaterial({ color: 0xFFFF00, emissive: 0xFFFF00, emissiveIntensity: 0.5 }); // Glowing orb
                    for (let i = 0; i < 3; i++) { // Initial 3 myonuclei
                        const myonucleus = new THREE.Mesh(myonucleusGeometry, myonucleusMaterial);
                        myonucleus.position.set(fiber.position.x + (i - 1) * 0.2, fiber.position.y, fiber.position.z + 0.05);
                        myonucleus.userData = { type: 'myonucleus', parentFiberId: fiber.userData.id };
                        fiber.add(myonucleus);
                    }

                    // Satellite Cells
                    const satelliteCellGeometry = new THREE.SphereGeometry(0.03, 8, 8);
                    const satelliteCellMaterial = new THREE.MeshBasicMaterial({ color: 0x90EE90, emissive: 0x90EE90, emissiveIntensity: 0.3 }); // Dormant green
                    const satelliteCell = new THREE.Mesh(satelliteCellGeometry, satelliteCellMaterial);
                    satelliteCell.position.set(fiber.position.x - 0.3, fiber.position.y + 0.07, fiber.position.z);
                    satelliteCell.userData = { type: 'satelliteCell', parentFiberId: fiber.userData.id, active: false };
                    fiber.add(satelliteCell);

                    return fiber;
                };

                // Create initial myofibers
                for (let i = 0; i < 5; i++) {
                    for (let j = 0; j < 2; j++) {
                        const fiber = createMyofiber((i - 2) * 1.2, (j - 0.5) * 0.2, 0, `${i}-${j}`);
                        muscleFibersGroupRef.current.add(fiber);
                    }
                }
                muscleFibersGroupRef.current.position.set(0, 0, 0); // Center the group
                muscleFibersGroupRef.current.scale.set(0.1, 0.1, 0.1); // Start small, will scale up on zoom
                scene.add(muscleFibersGroupRef.current);
                muscleFibersGroupRef.current.visible = false; // Hidden initially

                // Handle window resize
                const handleResize = () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                };
                window.addEventListener('resize', handleResize);

                // Animation loop
                const animate = () => {
                    animationFrameId.current = requestAnimationFrame(animate);
                    controls.update();
                    renderer.render(scene, camera);

                    // Update text meshes to face camera
                    textMeshesRef.current.forEach(mesh => {
                        mesh.quaternion.copy(camera.quaternion);
                    });

                    // Specific animations based on phase
                    if (currentPhase === 'stimulus') {
                        // Animate biceps curl (simplified rotation)
                        armModelRef.current.rotation.x = Math.sin(Date.now() * 0.001 * animationSpeed) * 0.5;
                        // Animate micro-tears (visual effect on fibers)
                        muscleFibersGroupRef.current.children.forEach(fiber => {
                            if (fiber.userData.type === 'myofiber') {
                                fiber.material.color.setHex(0xFF4500); // Orange-red for stress
                                if (Math.random() < 0.01 * animationSpeed) { // Randomly show micro-tears
                                    fiber.material.emissive.setHex(0xFF0000); // Red glow
                                    fiber.material.emissiveIntensity = 0.5;
                                } else {
                                    fiber.material.emissiveIntensity = 0;
                                }
                            }
                        });
                    } else if (currentPhase === 'adaptation') {
                        if (adaptationPathway === 'hypertrophy') {
                            muscleFibersGroupRef.current.children.forEach(fiber => {
                                if (fiber.userData.type === 'myofiber') {
                                    // Protein synthesis: fiber visibly thicker
                                    fiber.scale.lerp(new THREE.Vector3(fiber.userData.originalScale.x * 1.5, fiber.userData.originalScale.y * 1.5, fiber.userData.originalScale.z), 0.005 * animationSpeed);
                                    fiber.material.color.setHex(0x00BFFF); // Deep blue for growth

                                    // Satellite cell activation and fusion (simplified visual)
                                    fiber.children.forEach(child => {
                                        if (child.userData.type === 'satelliteCell' && !child.userData.active) {
                                            child.material.emissive.setHex(0x00FF00); // Bright green
                                            child.material.emissiveIntensity = 1;
                                            child.userData.active = true; // Mark as active

                                            // Simulate fusion by adding a new myonucleus
                                            if (Math.random() < 0.005 * animationSpeed) {
                                                const newMyonucleus = new THREE.Mesh(
                                                    new THREE.SphereGeometry(0.02, 8, 8),
                                                    new THREE.MeshBasicMaterial({ color: 0xFFFF00, emissive: 0xFFFF00, emissiveIntensity: 0.8 })
                                                );
                                                newMyonucleus.position.set(fiber.position.x + Math.random() * 0.4 - 0.2, fiber.position.y, fiber.position.z + 0.05);
                                                newMyonucleus.userData = { type: 'myonucleus', parentFiberId: fiber.userData.id, id: `dynamic-myonucleus-${Date.now()}-${Math.random()}` };
                                                fiber.add(newMyonucleus);
                                            }
                                        }
                                    });
                                }
                            });
                        } else if (adaptationPathway === 'hyperplasia') {
                            muscleFibersGroupRef.current.children.forEach(fiber => {
                                if (fiber.userData.type === 'myofiber') {
                                    fiber.material.color.setHex(0x8A2BE2); // Purple for hyperplasia

                                    // Simulate fiber splitting (visually by creating new smaller fibers)
                                    if (fiber.userData.id.includes('split') === false && Math.random() < 0.002 * animationSpeed) {
                                        const newFiber1 = fiber.clone();
                                        newFiber1.scale.set(fiber.scale.x * 0.7, fiber.scale.y * 0.7, fiber.scale.z);
                                        newFiber1.position.x -= 0.1;
                                        newFiber1.userData.id += '-split1';
                                        muscleFibersGroupRef.current.add(newFiber1);

                                        const newFiber2 = fiber.clone();
                                        newFiber2.scale.set(fiber.scale.x * 0.7, fiber.scale.y * 0.7, fiber.scale.z);
                                        newFiber2.position.x += 0.1;
                                        newFiber2.userData.id += '-split2';
                                        muscleFibersGroupRef.current.add(newFiber2);

                                        fiber.visible = false; // Hide original to simulate split
                                        setMyofiberCount(prev => prev + 2); // Increase count
                                    }

                                    // Simulate new fiber formation from satellite cells (visually by creating new fibers)
                                    fiber.children.forEach(child => {
                                        if (child.userData.type === 'satelliteCell' && !child.userData.active) {
                                            child.material.emissive.setHex(0x00FF00); // Bright green
                                            child.material.emissiveIntensity = 1;
                                            child.userData.active = true;

                                            if (Math.random() < 0.001 * animationSpeed) {
                                                const newFiber = createMyofiber(
                                                    fiber.position.x + Math.random() * 0.5 - 0.25,
                                                    fiber.position.y + Math.random() * 0.5 - 0.25,
                                                    fiber.position.z,
                                                    `new-${Date.now()}`
                                                );
                                                newFiber.scale.set(fiber.userData.originalScale.x * 0.5, fiber.userData.originalScale.y * 0.5, fiber.userData.originalScale.z);
                                                muscleFibersGroupRef.current.add(newFiber);
                                                setMyofiberCount(prev => prev + 1);
                                            }
                                        }
                                    });
                                }
                            });
                        }
                    } else if (currentPhase === 'result') {
                        // Final state: larger and/or more fibers, calm environment
                        armModelRef.current.rotation.x = 0; // Stop curl animation
                        muscleFibersGroupRef.current.children.forEach(fiber => {
                            if (fiber.userData.type === 'myofiber') {
                                fiber.material.color.setHex(0xADD8E6); // Back to calm blue
                                fiber.material.emissiveIntensity = 0;
                                fiber.children.forEach(child => {
                                    if (child.userData.type === 'satelliteCell') {
                                        child.material.emissiveIntensity = 0.3; // Back to dormant
                                    }
                                });
                            }
                        });
                    } else { // Initial state
                        armModelRef.current.rotation.x = 0;
                        muscleFibersGroupRef.current.children.forEach(fiber => {
                            if (fiber.userData.type === 'myofiber') {
                                fiber.material.color.setHex(0xADD8E6); // Light blue for quiescent
                                fiber.material.emissiveIntensity = 0;
                                fiber.children.forEach(child => {
                                    if (child.userData.type === 'satelliteCell') {
                                        child.material.emissiveIntensity = 0.3; // Dormant green
                                    }
                                    if (child.userData.type === 'myonucleus') {
                                        child.material.emissiveIntensity = 0.5; // Glowing orb
                                    }
                                });
                                fiber.scale.copy(fiber.userData.originalScale); // Reset size
                            }
                        });
                    }
                };

                animate();

                return () => {
                    window.removeEventListener('resize', handleResize);
                    cancelAnimationFrame(animationFrameId.current);
                    if (rendererRef.current && rendererRef.current.domElement) {
                        rendererRef.current.domElement.remove();
                    }
                    scene.remove(armModelRef.current);
                    scene.remove(muscleFibersGroupRef.current);
                    controls.dispose();
                    renderer.dispose();
                };
            }, [currentPhase, adaptationPathway, animationSpeed, createText]);

            // Handle user clicks/taps on 3D objects
            const onCanvasClick = React.useCallback((event) => {
                // Calculate mouse position in normalized device coordinates (-1 to +1)
                mouseRef.current.x = (event.clientX / window.innerWidth) * 2 - 1;
                mouseRef.current.y = -(event.clientY / window.innerHeight) * 2 + 1;

                raycasterRef.current.setFromCamera(mouseRef.current, cameraRef.current);

                const intersects = raycasterRef.current.intersectObjects(muscleFibersGroupRef.current.children, true);

                textMeshesRef.current.forEach(mesh => sceneRef.current.remove(mesh));
                textMeshesRef.current = []; // Clear previous labels

                if (intersects.length > 0) {
                    const intersectedObject = intersects[0].object;
                    const userData = intersectedObject.userData;

                    if (userData.type === 'myofiber') {
                        setShowInfo('Myofiber (Muscle Fiber)');
                        createText('Myofiber (Muscle Fiber)', intersectedObject.position.clone().add(new THREE.Vector3(0.2, 0.2, 0)));
                    } else if (userData.type === 'myonucleus') {
                        setShowInfo('Myonucleus: Controls protein synthesis.');
                        createText('Myonucleus: Controls protein synthesis.', intersectedObject.position.clone().add(new THREE.Vector3(0.2, 0.2, 0)));
                    } else if (userData.type === 'satelliteCell') {
                        setShowInfo('Satellite Cell: A muscle stem cell, currently inactive.');
                        if (currentPhase === 'adaptation' && userData.active) {
                            setShowInfo('Satellite Cell: Activated and contributing to muscle growth!');
                        }
                        createText('Satellite Cell: A muscle stem cell', intersectedObject.position.clone().add(new THREE.Vector3(0.2, 0.2, 0)));
                    } else if (currentPhase === 'stimulus' && intersectedObject.parent.userData.type === 'myofiber') {
                        // Simulate tapping on micro-tears
                        setShowInfo('Controlled micro-damage from resistance training is a key trigger for muscle growth.');
                        createText('Micro-damage!', intersectedObject.position.clone().add(new THREE.Vector3(0.2, 0.2, 0)));
                    }
                } else {
                    setShowInfo(''); // Clear info if no object is hit
                }
            }, [currentPhase, createText]);

            React.useEffect(() => {
                const canvas = rendererRef.current?.domElement;
                if (canvas) {
                    canvas.addEventListener('click', onCanvasClick);
                    return () => {
                        canvas.removeEventListener('click', onCanvasClick);
                    };
                }
            }, [onCanvasClick]);

            // Camera and model transitions based on zoom state
            React.useEffect(() => {
                if (isZoomedIn) {
                    // Zoom into microscopic view
                    cameraRef.current.position.set(0, 0, 1.5);
                    controlsRef.current.target.set(0, 0, 0);
                    armModelRef.current.visible = false;
                    muscleFibersGroupRef.current.visible = true;
                    muscleFibersGroupRef.current.scale.set(1, 1, 1); // Scale up to normal size
                } else {
                    // Zoom out to arm view
                    cameraRef.current.position.set(0, 2, 5);
                    controlsRef.current.target.set(0, 1.5, 0);
                    armModelRef.current.visible = true;
                    muscleFibersGroupRef.current.visible = false;
                }
                controlsRef.current.update();
            }, [isZoomedIn]);

            // Reset scene state
            const resetScene = React.useCallback(() => {
                setCurrentPhase('initial');
                setAdaptationPathway(null);
                setIsZoomedIn(false);
                setMyofiberCount(10);
                setShowInfo('');
                // Reset 3D models to initial state
                muscleFibersGroupRef.current.children.forEach(fiber => {
                    if (fiber.userData.type === 'myofiber') {
                        fiber.visible = true; // Make hidden fibers visible again
                        fiber.scale.copy(fiber.userData.originalScale); // Reset scale
                        fiber.material.color.setHex(0xADD8E6); // Reset color
                        fiber.material.emissiveIntensity = 0;

                        // Reset myonuclei and satellite cells
                        fiber.children.forEach(child => {
                            if (child.userData.type === 'satelliteCell') {
                                child.material.emissiveIntensity = 0.3;
                                child.userData.active = false;
                            }
                            if (child.userData.type === 'myonucleus') {
                                child.material.emissiveIntensity = 0.5;
                            }
                        });
                        // Remove dynamically added myonuclei (simple approach, might need more robust ID management)
                        fiber.children = fiber.children.filter(child => !child.userData.id?.includes('dynamic'));
                    }
                });
                // Remove dynamically added fibers for hyperplasia
                const initialFiberCount = 10; // Based on initial creation loop (5*2)
                // Filter out fibers that were dynamically added (i.e., not part of the initial 10)
                const currentFibers = [...muscleFibersGroupRef.current.children];
                currentFibers.forEach(fiber => {
                    if (fiber.userData.id && (fiber.userData.id.includes('split') || fiber.userData.id.includes('new-'))) {
                        muscleFibersGroupRef.current.remove(fiber);
                    }
                });
                // Re-add the initial fibers if they were removed/hidden
                // This part is tricky with direct Three.js manipulation. A more robust solution would be to
                // re-initialize the muscleFibersGroupRef.current with fresh fibers, or manage a pool.
                // For simplicity here, we assume the initial 10 are always present and just reset their state.
                // If fibers were *removed* from the group, they need to be re-created.
                // Let's ensure the initial fibers are always there and just reset their state.
                // The current implementation hides `fiber.visible = false;` for splitting, so we just need to make them visible again.
                // The `while` loop for removing dynamically added fibers is more robust if fibers were truly added.
                // Let's ensure we only remove the ones created by hyperplasia.
                const fibersToRemove = [];
                muscleFibersGroupRef.current.children.forEach(fiber => {
                    if (fiber.userData.id && (fiber.userData.id.includes('split') || fiber.userData.id.includes('new-'))) {
                        fibersToRemove.push(fiber);
                    }
                });
                fibersToRemove.forEach(fiber => muscleFibersGroupRef.current.remove(fiber));


            }, []);

            const handleStartTraining = () => {
                setCurrentPhase('stimulus');
                setIsZoomedIn(true); // Auto-zoom into microscopic view
            };

            const handleSelectHypertrophy = () => {
                setAdaptationPathway('hypertrophy');
                setCurrentPhase('adaptation');
            };

            const handleSelectHyperplasia = () => {
                setAdaptationPathway('hyperplasia');
                setCurrentPhase('adaptation');
            };

            const handleShowResult = () => {
                setCurrentPhase('result');
                setIsZoomedIn(false); // Zoom out to see the larger arm
            };

            return (
                <div className="relative w-screen h-screen overflow-hidden font-inter bg-gray-900 text-white">
                    {/* Scene Container */}
                    <div id="scene-container" className="absolute inset-0 z-0"></div>

                    {/* UI Overlay */}
                    <div className="relative z-10 p-4 flex flex-col h-full">
                        {/* Header */}
                        <div className="text-center mb-4">
                            <h1 className="text-3xl md:text-4xl font-bold text-blue-300 drop-shadow-lg">The Microscopic Giants</h1>
                            <p className="text-md md:text-lg text-gray-300">Building Muscle with Strength Training</p>
                        </div>

                        {/* Info Panel */}
                        {showInfo && (
                            <div className="absolute top-4 right-4 bg-gradient-to-br from-blue-700 to-purple-800 text-white p-3 rounded-lg shadow-xl max-w-xs md:max-w-sm text-sm md:text-base animate-fade-in-down">
                                <p>{showInfo}</p>
                            </div>
                        )}

                        {/* Main Controls */}
                        <div className="flex-grow flex items-center justify-center">
                            <div className="flex flex-col space-y-4 p-6 bg-gray-800 bg-opacity-80 rounded-xl shadow-2xl border border-gray-700">
                                {currentPhase === 'initial' && (
                                    <>
                                        <button
                                            onClick={() => setIsZoomedIn(!isZoomedIn)}
                                            className="flex items-center justify-center px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-75"
                                        >
                                            {isZoomedIn ? <ZoomOut className="mr-2" /> : <ZoomIn className="mr-2" />}
                                            {isZoomedIn ? 'Zoom Out to Arm' : 'Zoom In to Muscle'}
                                        </button>
                                        <button
                                            onClick={handleStartTraining}
                                            className="flex items-center justify-center px-6 py-3 bg-green-600 hover:bg-green-700 text-white font-semibold rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-75"
                                        >
                                            <Play className="mr-2" />
                                            Start Strength Training
                                        </button>
                                    </>
                                )}

                                {currentPhase === 'stimulus' && (
                                    <>
                                        <div className="text-center text-lg text-yellow-300">Muscle Under Stress!</div>
                                        <div className="flex space-x-2">
                                            <button
                                                onClick={() => setAnimationSpeed(0.5)}
                                                className="flex items-center justify-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105"
                                            >
                                                <Rewind className="mr-1" size={18} /> Slow
                                            </button>
                                            <button
                                                onClick={() => setAnimationSpeed(1)}
                                                className="flex items-center justify-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105"
                                            >
                                                <Play className="mr-1" size={18} /> Normal
                                            </button>
                                            <button
                                                onClick={() => setAnimationSpeed(2)}
                                                className="flex items-center justify-center px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white font-semibold rounded-full shadow-md transition duration-300 ease-in-out transform hover:scale-105"
                                            >
                                                <FastForward className="mr-1" size={18} /> Fast
                                            </button>
                                        </div>
                                        <button
                                            onClick={() => setCurrentPhase('adaptation')}
                                            className="flex items-center justify-center px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-75"
                                        >
                                            <Activity className="mr-2" />
                                            Proceed to Adaptation
                                        </button>
                                    </>
                                )}

                                {currentPhase === 'adaptation' && (
                                    <>
                                        <div className="text-center text-lg text-cyan-300">Choose Adaptation Pathway:</div>
                                        <button
                                            onClick={handleSelectHypertrophy}
                                            className={`flex items-center justify-center px-6 py-3 font-semibold rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-opacity-75 ${adaptationPathway === 'hypertrophy' ? 'bg-blue-800' : 'bg-blue-600 hover:bg-blue-700'} text-white`}
                                        >
                                            <Scale className="mr-2" />
                                            Pathway A: Hypertrophy (Bigger)
                                        </button>
                                        <button
                                            onClick={handleSelectHyperplasia}
                                            className={`flex items-center justify-center px-6 py-3 font-semibold rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-opacity-75 ${adaptationPathway === 'hyperplasia' ? 'bg-purple-800' : 'bg-purple-600 hover:bg-purple-700'} text-white`}
                                        >
                                            <Plus className="mr-2" />
                                            Pathway B: Hyperplasia (More Fibers)
                                        </button>
                                        {adaptationPathway && (
                                            <button
                                                onClick={handleShowResult}
                                                className="flex items-center justify-center px-6 py-3 bg-orange-600 hover:bg-orange-700 text-white font-semibold rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-opacity-75"
                                            >
                                                <ArrowLeftRight className="mr-2" />
                                                Show Result
                                            </button>
                                        )}
                                    </>
                                )}

                                {currentPhase === 'result' && (
                                    <>
                                        <div className="text-center text-lg text-lime-300">Muscle Adapted!</div>
                                        <div className="bg-gray-700 p-4 rounded-lg shadow-inner text-sm md:text-base">
                                            <h3 className="font-bold mb-2">Summary:</h3>
                                            <p className="mb-1">
                                                <span className="font-semibold text-blue-400">Hypertrophy:</span> Muscle fibers grow larger in diameter due to increased protein synthesis and myonuclei.
                                            </p>
                                            <p>
                                                <span className="font-semibold text-purple-400">Hyperplasia:</span> Total number of muscle fibers increases through splitting or new fiber formation.
                                            </p>
                                        </div>
                                        <button
                                            onClick={resetScene}
                                            className="flex items-center justify-center px-6 py-3 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-full shadow-lg transition duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-75"
                                        >
                                            <Circle className="mr-2" />
                                            Reset Scene
                                        </button>
                                    </>
                                )}
                            </div>
                        </div>

                        {/* Myofiber Count Display */}
                        {isZoomedIn && (
                            <div className="absolute bottom-4 left-4 bg-gray-800 bg-opacity-70 text-white p-3 rounded-lg shadow-lg text-sm md:text-base">
                                Total Myofiber Count: <span className="font-bold text-yellow-400">{myofiberCount}</span>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        // Render the React application
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
